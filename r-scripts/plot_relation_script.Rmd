```{r user-input}
  rm(list = ls(all = T))
  dropbox.path              <- "dropbox-path/"
  activity.path             <- "activity/" 
  person.path               <- "lastname-firstname/"
  date.path                 <- "YYYY-mm-dd_HH-MM-SS/"

  activity        <- "activity"
  sex             <- "sex"
  age             <- "0"
  total.subsets   <- 0
```

```{r functions}
  source("./functions.R")
```

```{r plot-relation}
  directories <- list.dirs(path = paste(dropbox.path, "data-flow/final-data/", activity.path, person.path, sep = ""), recursive = F)

  data.matrix <- data.frame()
  for (directory in directories) {
    
    # extract fss factors
      file.path   <- paste(directory, "/", "scale.csv", sep ="")
      scale.items <- read.csv(file.path)
      fss.factors <- CalculateFlowShortScaleFactors(scale.items)

    for (subset in 1:total.subsets) {
    
    # extract rr intervals and psd values 
      file.path     <- paste(directory, "/", "subset-", subset, "/hrv-data-spss.txt", sep ="")
      
      if(file.exists(file.path)) {
      
      # extract hrv parameters
        spss.hrv.data <- read.csv(file.path)
        
      # add data to data matrix
        data.matrix <- rbind(data.matrix, cbind(fss.factors[subset,], spss.hrv.data[,2:(length(spss.hrv.data) - 1)], subset = subset))
      }
    }
  }

  # data.table <- subset(data.matrix, select = c("subset", "flow", "fluency", "absorption", "anxiety", "fit", "meanhr", "lfpowfft", "hfpowfft", "totpowfft", "lfhffft", "lfpownufft", "hfpownufft"))
  # colnames(data.table) <- c("Subset", "Flow", "Fluency", "Absorption", "Anxiety", "Fit", "Mean HR", "LF Power (FFT)", "HF Power (FFT)", "Total Power (FFT)", "LF/HF (FFT)", "LF Power (FFT) n. u", "HF Power (FFT) n. u")
  # rownames(data.table) <- c(as.character(as.POSIXct(data.matrix[, 1] / 1000, tz = "Europe/Berlin", origin = "1970-01-01")))
  # data.table <- as.table(data.table)
  # data.table

# plot relation
  file.path     <- paste(dropbox.path, "data-flow/final-data/", activity.path, person.path, "flow-hrv-relation.pdf", sep = "")
  pdf(file.path, width = 11, height = 8, paper = "a4")
      
  par(mfrow = c(2, 1))
  PlotRelation(data.matrix$lfpowfft, data.matrix$flow, main = "", xlab = "Power LF-Band (ms^2)", ylab = "Flow", ylim = c(2, 7), pch = 20)
  
  title(main = paste("Relation - Activity: ", activity, ", Sex: ", sex, ", Age: ", age, sep = ""))
  
  PlotRelation(data.matrix$hfpowfft, data.matrix$flow, main = "", xlab = "Power HF-Band (ms^2)", ylab = "Flow", ylim = c(2, 7), pch = 20)

  dev.off()
```